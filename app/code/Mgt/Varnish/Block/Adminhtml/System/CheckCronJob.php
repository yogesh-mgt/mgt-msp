<?php
 namespace Mgt\Varnish\Block\Adminhtml\System; class CheckCronJob extends \Magento\Backend\Block\Template { const CACHE_WARMER_CACHE_KEY = "\115\x67\x74\x43\x61\x63\x68\145\x57\x61\162\155\145\x72"; const CRON_WARNING_MESSAGE_MINUTES = 10; protected $cache; protected $varnishConfig; protected $config; protected $directoryList; public function __construct(\Magento\Backend\Block\Template\Context $context, \Magento\Framework\App\Filesystem\DirectoryList $directoryList, \Mgt\Varnish\Model\Cache\Backend\File $cache, \Magento\Framework\App\Config $config, \Mgt\Varnish\Model\Cache\Config $varnishConfig, array $data = []) { goto d0aed; eedcc: $this->directoryList = $directoryList; goto E53ca; e2bca: $this->varnishConfig = $varnishConfig; goto Ffcfe; d0aed: parent::__construct($context, $data); goto eedcc; F5c66: $this->config = $config; goto e2bca; E53ca: $this->cache = $cache; goto F5c66; Ffcfe: } public function isVarnishEnabled() { $isVarnishEnabled = $this->varnishConfig->isEnabled(); return $isVarnishEnabled; } public function isCacheWarmerEnabled() { $isCacheWarmerEnabled = $this->varnishConfig->isCacheWarmerEnabled(); return $isCacheWarmerEnabled; } public function showCronNotRunningMessage() { goto c9eac; d9712: if (!($totalMinutes >= self::CRON_WARNING_MESSAGE_MINUTES)) { goto c3467; } goto bbf83; d7e58: $lastRunning->setTimezone(new \DateTimeZone("\125\124\103")); goto F9826; B9338: c3467: goto e6552; eda05: $lastRunningTimestamp = $this->getLastRunningTimestamp(); goto A2ee2; ac2ba: $isVarnishEnabled = $this->isVarnishEnabled(); goto f332b; c9eac: $showCronNotRunningMessage = false; goto ac2ba; c13a5: $totalMinutes += $dateDiff->h * 60; goto b3484; e6552: goto ea46f; goto c9460; e4b3c: return $showCronNotRunningMessage; goto C021b; C34d3: if (!(true === $isVarnishEnabled && true === $isCacheWarmerEnabled)) { goto A7109; } goto eda05; E3f9b: $totalMinutes = $dateDiff->days * 24 * 60; goto c13a5; f2240: ea46f: goto ab363; bbf83: $showCronNotRunningMessage = true; goto B9338; c052e: $dateDiff = $now->diff($lastRunning); goto E3f9b; f691f: $now = new \DateTime("\156\x6f\x77", new \DateTimeZone("\125\x54\103")); goto D2d9d; b3484: $totalMinutes += $dateDiff->i; goto d9712; E2f9b: $showCronNotRunningMessage = true; goto f2240; D2d9d: $lastRunning = new \Datetime(); goto d7e58; ab363: A7109: goto e4b3c; f332b: $isCacheWarmerEnabled = $this->isCacheWarmerEnabled(); goto C34d3; F9826: $lastRunning->setTimestamp($lastRunningTimestamp); goto c052e; c9460: bfef1: goto E2f9b; A2ee2: if (0 == $lastRunningTimestamp) { goto bfef1; } goto f691f; C021b: } protected function getLastRunningTimestamp() { $lastRunningTimestamp = (int) $this->cache->load(self::CACHE_WARMER_CACHE_KEY); return $lastRunningTimestamp; } public function getCronJobCommand() { $cronJobCommand = sprintf("\x70\x68\x70\x20\x25\163\x2f\142\151\x6e\57\x6d\x61\147\145\156\x74\x6f\40\x6d\147\164\x2d\x76\141\x72\156\151\163\150\x3a\x63\141\x63\150\145\55\167\x61\x72\x6d\145\x72", $this->directoryList->getRoot()); return $cronJobCommand; } }
