<?php
 namespace Mgt\Varnish\Controller\Api; class PurgeUrl extends \Magento\Framework\App\Action\Action { protected $cachePurger; protected $config; public function __construct(\Magento\Framework\App\Action\Context $context, \Magento\CacheInvalidate\Model\PurgeCache $cachePurger, \Mgt\Varnish\Model\Cache\Config $config) { goto Ad761; Bd8a7: parent::__construct($context); goto E71f4; Ad761: $this->cachePurger = $cachePurger; goto dc2ef; dc2ef: $this->config = $config; goto Bd8a7; E71f4: } public function execute() { goto F8cc9; Fdedd: if (!($secretKey && $url)) { goto Eaa00; } goto c86c3; Eb0a8: exit; goto C3913; A3fd9: $secretKey = $request->getParam("\163\x65\143\162\145\x74\x4b\145\171"); goto f89ad; a6cdc: $body = json_encode($body); goto D7dca; Be927: $response->sendResponse(); goto Eb0a8; Ae93c: $response->setBody($body); goto Be927; D7dca: $response->setHeader("\103\x6f\x6e\164\x65\156\164\55\x54\171\x70\145", "\x61\x70\160\x6c\x69\143\141\x74\x69\157\156\x2f\152\163\x6f\156"); goto Ae93c; F9451: $response = $this->getResponse(); goto e0165; e0165: $body = []; goto A3fd9; c86c3: try { goto D4806; D1aa0: $body = ["\163\x75\143\143\145\163\163" => 1, "\155\145\163\163\x61\147\145" => sprintf("\x54\150\x65\40\x55\122\114\40\42\x25\x73\x22\x20\x68\x61\x73\40\x62\145\x65\156\x20\x70\x75\162\147\x65\144\56", $url)]; goto cd020; ffdf3: Dc528: goto C67db; D4806: $apiSecretKey = $this->config->getApiSecretKey(); goto aa7cd; C67db: $this->cachePurger->purgeUrlRequest($url); goto D1aa0; aa7cd: if (!($secretKey != $apiSecretKey)) { goto Dc528; } goto Dbe81; Dbe81: throw new \Exception("\123\145\143\x72\145\164\x20\x61\x70\151\x20\153\145\171\x20\151\x73\40\x6e\x6f\164\x20\x63\x6f\x72\162\145\143\164"); goto ffdf3; cd020: } catch (\Exception $e) { $errorMessage = $e->getMessage(); $body = ["\163\165\143\x63\145\x73\163" => 0, "\x6d\x65\163\163\x61\x67\x65" => $errorMessage]; } goto d653d; F8cc9: $request = $this->getRequest(); goto F9451; f89ad: $url = $request->getParam("\x75\162\x6c"); goto Fdedd; d653d: Eaa00: goto a6cdc; C3913: } }
