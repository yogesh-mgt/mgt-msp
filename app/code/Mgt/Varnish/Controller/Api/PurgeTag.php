<?php
 namespace Mgt\Varnish\Controller\Api; class PurgeTag extends \Magento\Framework\App\Action\Action { protected $cachePurger; protected $config; public function __construct(\Magento\Framework\App\Action\Context $context, \Magento\CacheInvalidate\Model\PurgeCache $cachePurger, \Mgt\Varnish\Model\Cache\Config $config) { goto D7949; F0ca4: parent::__construct($context); goto c8c88; A2151: $this->config = $config; goto F0ca4; D7949: $this->cachePurger = $cachePurger; goto A2151; c8c88: } public function execute() { goto a5d8b; Bf8c5: $response = $this->getResponse(); goto fa37f; Eeeff: if (!($secretKey && $tag)) { goto A3a7c; } goto bd4d8; E757a: $tag = $request->getParam("\x74\141\x67"); goto Eeeff; c69c1: $response->setHeader("\x43\x6f\156\x74\145\x6e\164\x2d\124\171\160\x65", "\x61\160\160\x6c\151\143\141\x74\151\157\x6e\57\152\x73\x6f\x6e"); goto Ed5b7; Ee1d0: $response->sendResponse(); goto f9dad; a5d8b: $request = $this->getRequest(); goto Bf8c5; beccf: $body = json_encode($body); goto c69c1; f9dad: exit; goto b060a; Ed5b7: $response->setBody($body); goto Ee1d0; c4d73: A3a7c: goto beccf; Bd039: $secretKey = $request->getParam("\x73\145\143\x72\x65\x74\113\x65\x79"); goto E757a; bd4d8: try { goto F473a; E8df4: b4f3d: goto Ee8f5; D034a: throw new \Exception("\x53\x65\143\x72\x65\x74\x20\141\x70\x69\40\x6b\145\x79\40\x69\163\x20\156\157\x74\x20\x63\157\162\x72\x65\x63\164"); goto E8df4; B95ac: $this->cachePurger->sendPurgeRequest($tags); goto c8bc8; c8bc8: $body = ["\163\165\x63\143\145\163\x73" => 1, "\155\x65\x73\x73\141\147\x65" => sprintf("\126\141\162\156\x69\163\150\40\x43\141\x63\150\x65\40\160\165\162\x67\x65\x64\x20\142\x79\x20\x66\157\x6c\x6c\x6f\167\151\x6e\147\x20\x74\141\x67\x3a\40\x25\x73", $tag)]; goto bac42; Ee8f5: $tags = [$tag]; goto B95ac; F473a: $apiSecretKey = $this->config->getApiSecretKey(); goto e6d58; e6d58: if (!($secretKey != $apiSecretKey)) { goto b4f3d; } goto D034a; bac42: } catch (\Exception $e) { $errorMessage = $e->getMessage(); $body = ["\x73\x75\x63\x63\x65\163\163" => 0, "\x6d\x65\163\163\141\147\145" => $errorMessage]; } goto c4d73; fa37f: $body = []; goto Bd039; b060a: } }
