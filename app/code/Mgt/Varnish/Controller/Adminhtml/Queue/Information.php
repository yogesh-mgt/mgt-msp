<?php
 namespace Mgt\Varnish\Controller\Adminhtml\Queue; class Information extends \Magento\Backend\App\Action { const SQL_LIMIT_URL_QUEUE = 500; protected $jsonHelper; protected $storeManager; protected $urlQueueCollection; public function __construct(\Magento\Backend\App\Action\Context $context, \Magento\Framework\Json\Helper\Data $jsonHelper, \Magento\Store\Model\StoreManagerInterface $storeManager, \Mgt\Varnish\Model\ResourceModel\UrlQueue\Collection $urlQueueCollection) { goto c4418; c4418: parent::__construct($context); goto dfcdf; eaf49: $this->storeManager = $storeManager; goto C2556; dfcdf: $this->jsonHelper = $jsonHelper; goto F51bf; F51bf: $this->urlQueueCollection = $urlQueueCollection; goto eaf49; C2556: } public function execute() { goto a91ec; aebc2: $response->representJson($this->jsonHelper->jsonEncode($data)); goto a8ca4; a91ec: $numberOfUrls = $this->urlQueueCollection->getSize(); goto eb938; C4c0f: $data = ["\x6e\x75\x6d\x62\x65\x72\117\146\x55\x72\x6c\x73" => $numberOfUrls, "\x63\157\x6e\x74\145\x6e\x74" => implode("\74\x62\x72\76", $urlsInQueue)]; goto E93e8; eb938: $urlsInQueue = $this->getUrlsFromQueue(); goto C4c0f; E93e8: $response = $this->getResponse(); goto aebc2; a8ca4: return $response; goto c2b60; c2b60: } public function getUrlsFromQueue() { goto Fa168; D14c2: $this->urlQueueCollection->setPageSize(self::SQL_LIMIT_URL_QUEUE); goto E804a; c4f21: return $urls; goto C03ac; Bde60: $this->urlQueueCollection->addOrder("\x70\162\151\157\x72\x69\x74\171"); goto D14c2; Fa168: $urls = []; goto Bde60; E804a: $this->urlQueueCollection->load(); goto de9d3; A021c: faa29: goto c4f21; de9d3: foreach ($this->urlQueueCollection as $url) { goto e8310; C19e7: d808d: goto Bd450; f858b: $store = $this->storeManager->getStore($storeId); goto a5992; fa761: $urls[] = $url; goto C19e7; e8310: $storeId = $url->getStoreId(); goto f858b; a5992: $url = sprintf("\x25\163\57\x25\x73", rtrim($store->getBaseUrl(), "\57"), ltrim($url->getPath(), "\x2f")); goto fa761; Bd450: } goto A021c; C03ac: } }
