<?php
 namespace Mgt\Varnish\Model\Observer; use Magento\Framework\Event\ObserverInterface; use Magento\Framework\Event\Observer; class SaveConfigObserver implements ObserverInterface { const FULL_PAGE_CACHE_STATUS_ENABLED = 1; const FULL_PAGE_CACHE_STATUS_DISABLED = 0; protected $config; protected $deploymentConfigWriter; protected $configValueFactory; protected $cachePurger; protected $cacheTypeList; public function __construct(\Mgt\Varnish\Model\Cache\Config $config, \Magento\Framework\App\DeploymentConfig\Writer $deploymentConfigWriter, \Magento\Framework\App\Config\ValueFactory $configValueFactory, \Magento\CacheInvalidate\Model\PurgeCache $cachePurger, \Magento\Framework\App\Cache\TypeListInterface $cacheTypeList) { goto da602; F7a3c: $this->cacheTypeList = $cacheTypeList; goto Ab64a; cc924: $this->configValueFactory = $configValueFactory; goto efbff; efbff: $this->cachePurger = $cachePurger; goto F7a3c; c5822: $this->deploymentConfigWriter = $deploymentConfigWriter; goto cc924; da602: $this->config = $config; goto c5822; Ab64a: } public function execute(Observer $observer) { $isVarnishEnabled = $this->config->isEnabled(); try { goto D646a; B9b3a: $appEnvDataCacheTypes = []; goto Bb6bd; dafad: if (!isset($cacheTypes["\146\165\154\154\x5f\x70\141\147\x65"])) { goto A7809; } goto C87d5; E7598: cacc7: goto bc5e7; D9e25: foreach ($cacheTypes as $cacheTypeKey => $cacheType) { $appEnvDataCacheTypes["\x61\x70\160\x5f\145\156\166"]["\143\141\143\150\145\137\x74\171\160\x65\163"][$cacheTypeKey] = (int) $cacheType->getStatus(); bcc23: } goto e64ca; C0b14: c5654: goto F0a5d; Cd02b: $configValue->setValue(\Magento\PageCache\Model\Config::VARNISH); goto bb1cc; e60f7: $this->deploymentConfigWriter->saveConfig($appEnvDataCacheTypes, true); goto Bda6d; a17c9: $cacheTypes["\146\x75\154\154\x5f\x70\141\x67\x65"]->setStatus(self::FULL_PAGE_CACHE_STATUS_ENABLED); goto C0b14; bb1cc: $configValue->save(); goto C0edb; e55de: if (!$configValue->getId()) { goto D56bb; } goto C5fee; Bb6bd: if (!$cacheTypes) { goto A81d8; } goto D9e25; D5031: goto F9722; goto E7598; dae1a: D56bb: goto dafad; B7b18: A7809: goto d0a9e; bc5e7: $configValue->setPath(\Magento\PageCache\Model\Config::XML_PAGECACHE_TYPE); goto Cd02b; C0edb: if (!isset($cacheTypes["\x66\x75\154\154\x5f\160\141\x67\145"])) { goto c5654; } goto a17c9; C87d5: $cacheTypes["\146\x75\x6c\154\x5f\x70\x61\x67\145"]->setStatus(self::FULL_PAGE_CACHE_STATUS_DISABLED); goto B7b18; C5fee: $configValue->delete(); goto dae1a; D646a: $configValue = $this->configValueFactory->create(); goto d8614; d0a9e: $this->cachePurger->sendPurgeRequest("\x2a"); goto D5031; A5d54: if (true === $isVarnishEnabled) { goto cacc7; } goto e55de; e64ca: d5c0c: goto c60a5; ed3df: $cacheTypes = $this->cacheTypeList->getTypes(); goto A5d54; F0a5d: F9722: goto B9b3a; c60a5: A81d8: goto e60f7; d8614: $configValue->load(\Magento\PageCache\Model\Config::XML_PAGECACHE_TYPE, "\x70\141\164\150"); goto ed3df; Bda6d: } catch (\Exception $e) { throw new $e(); } } }
