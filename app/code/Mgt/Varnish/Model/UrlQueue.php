<?php
 namespace Mgt\Varnish\Model; use Zend\Uri\Uri; class UrlQueue extends \Magento\Framework\Model\AbstractModel { const PRIORITY_HIGH = 1000; const PRIORITY_MEDIUM = 500; const PRIORITY_LOW = 100; protected $storeManager; protected $license; protected $licenseCache = []; public function __construct(\Magento\Framework\Model\Context $context, \Magento\Framework\Registry $registry, \Mgt\Varnish\Model\ResourceModel\UrlQueue $resource, \Magento\Store\Model\StoreManagerInterface $storeManager, \Mgt\Varnish\Model\License $license) { goto fdccb; c3f4f: $this->storeManager = $storeManager; goto c7a6b; c7a6b: $this->license = $license; goto Dadf6; fdccb: parent::__construct($context, $registry, $resource); goto c3f4f; Dadf6: } protected function _construct() { $this->_init("\115\x67\164\x5c\126\141\x72\156\151\x73\150\134\115\x6f\144\145\154\134\x52\x65\x73\x6f\165\162\x63\x65\x4d\x6f\x64\x65\x6c\x5c\x55\162\x6c\121\x75\x65\165\145"); } public function getId() { return parent::getData("\165\x72\154\x5f\151\144"); } public function addToQueue(array $urls) { goto F2777; F2f53: $resource->addToQueue($urls); goto d6f7a; F2777: $urls = $this->filterUrls($urls); goto D96e8; Dcc00: $resource = $this->_getResource(); goto F2f53; D96e8: if (!$urls) { goto d487c; } goto Dcc00; d6f7a: d487c: goto de3a6; de3a6: } protected function filterUrls(array $urls) { goto B81df; B81df: $filteredUrls = []; goto e5c7a; db307: fec28: goto Cf7e5; Cf7e5: return $filteredUrls; goto ade95; e5c7a: foreach ($urls as $url) { goto aae4a; ce660: if (!(true === $canAddUrlToQueue)) { goto Df70b; } goto Cdacd; Cdacd: $filteredUrls[] = $url; goto Afb85; D2fb8: $url["\160\x61\164\150"] = ltrim($url["\x70\141\x74\x68"], "\x2f"); goto Ab57a; aae4a: $storeId = (int) $url["\163\164\x6f\x72\145\137\151\144"]; goto D2fb8; Ab57a: $canAddUrlToQueue = $this->canAddUrlToQueue($storeId); goto ce660; Afb85: Df70b: goto C17f2; C17f2: C788d: goto Adaa9; Adaa9: } goto db307; ade95: } protected function canAddUrlToQueue($storeId) { goto B8d81; C7afa: Bb84d: goto d64a0; B3c8a: return $canAddUrlToQueue; goto B6733; C82ee: goto Bb84d; goto Ba38e; d64a0: goto ddf17; goto A1e25; Da193: $this->licenseCache[$storeId] = $hasLicense; goto a705a; E58d6: $canAddUrlToQueue = $this->licenseCache[$storeId]; goto B3c8a; C4779: $host = $uri->getHost(); goto a1197; B6733: ddf17: goto C0dd3; a705a: if (true === $hasLicense) { goto B2942; } goto fd8ae; A1e25: Ae94a: goto E58d6; Cbce0: return true; goto C7afa; fd8ae: return false; goto C82ee; a1197: $hasLicense = $this->license->hasLicense($host); goto Da193; B8d81: if (isset($this->licenseCache[$storeId])) { goto Ae94a; } goto C1792; C1792: $store = $this->storeManager->getStore($storeId); goto d9bdf; Ba38e: B2942: goto Cbce0; d9bdf: $uri = new Uri($store->getBaseUrl()); goto C4779; C0dd3: } }
