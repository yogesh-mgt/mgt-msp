<?php
 namespace Mgt\Waf\Model\Aws; use Aws\WAFV2\WAFV2Client as WafClient; use Aws\Credentials\Credentials; use Mgt\Waf\Model\Util\Retry; class Waf { const WEB_ACL_RULE_NAME_BLOCKED_COUNTRIES = "\x42\x6c\x6f\143\153\x2d\x43\157\165\156\x74\162\x69\x65\163"; const WEB_ACL_RULE_NAME_RATE_LIMIT_IPV4 = "\x52\x61\x74\x65\x2d\x4c\151\155\151\164\55\111\120\x76\x34"; const WEB_ACL_RULE_NAME_RATE_LIMIT_IPV6 = "\x52\x61\164\145\55\x4c\x69\155\151\164\x2d\x49\120\166\66"; const WEB_ACL_RULE_BLOCK_MAGENTO_BACKEND_ACCESS = "\102\x6c\x6f\143\153\55\x4d\x61\x67\145\x6e\x74\157\x2d\x42\x61\x63\153\x65\156\144\55\101\x63\x63\x65\163\x73"; const WEB_ACL_RULE_ALLOW_MAGENTO_BACKEND_ACCESS_IPV4 = "\x41\154\154\x6f\x77\55\x4d\141\147\145\156\164\157\x2d\102\141\x63\153\145\x6e\x64\x2d\x41\143\x63\145\x73\163\x2d\x49\120\166\x34"; const WEB_ACL_RULE_ALLOW_MAGENTO_BACKEND_ACCESS_IPV6 = "\x41\154\154\157\167\55\115\141\x67\x65\x6e\164\x6f\x2d\x42\x61\x63\x6b\145\156\x64\x2d\x41\143\143\145\163\163\x2d\x49\120\166\x36"; const IP_SET_BLOCKED_IPS_IPV4 = "\102\154\x6f\143\x6b\x65\x64\x2d\111\120\x73\55\111\120\166\x34"; const IP_SET_BLOCKED_IPS_IPV6 = "\x42\154\157\143\x6b\x65\144\x2d\x49\x50\x73\x2d\x49\x50\166\66"; const IP_SET_RATE_LIMIT_WHITELISTED_IPV4 = "\122\141\x74\x65\x2d\x4c\x69\x6d\x69\x74\55\127\x68\151\164\x65\154\x69\163\164\x65\x64\55\x49\120\x76\x34"; const IP_SET_RATE_LIMIT_WHITELISTED_IPV6 = "\x52\141\x74\x65\x2d\x4c\x69\x6d\151\x74\x2d\127\150\x69\164\x65\154\x69\163\164\x65\144\x2d\x49\120\166\x36"; const IP_SET_MAGENTO_BACKEND_WHITELISTED_IPV4 = "\115\x61\147\145\x6e\164\157\x2d\x42\x61\143\x6b\145\156\144\x2d\x57\x68\151\164\145\x6c\151\x73\164\x65\x64\x2d\111\x50\x76\64"; const IP_SET_MAGENTO_BACKEND_WHITELISTED_IPV6 = "\x4d\x61\147\x65\156\164\x6f\x2d\102\141\x63\153\145\x6e\x64\55\127\150\x69\164\x65\x6c\x69\x73\x74\x65\x64\x2d\x49\120\166\66"; const REGEX_PATTERN_SET_BLOCKED_BOTS = "\102\x6c\x6f\143\153\145\144\x2d\x42\157\x74\163"; const SCOPE_REGIONAL = "\122\105\x47\111\117\x4e\101\x4c"; protected $awsAccessKey; protected $awsSecretAccessKey; protected $awsRegion; protected $projectName; protected $wafClient; protected $credentials; protected $webAcls = []; protected $webAclCache = []; protected $ipSets = []; protected $regexPatternSets = []; public function __construct($awsAccessKey, $awsSecretAccessKey, $awsRegion, $projectName) { goto A2a88; ad487: $this->awsSecretAccessKey = $awsSecretAccessKey; goto Fe764; F1203: $this->projectName = $projectName; goto Cf1f2; Fe764: $this->awsRegion = $awsRegion; goto F1203; A2a88: $this->awsAccessKey = $awsAccessKey; goto ad487; Cf1f2: } public function getWafClient() { goto Ef754; fea4f: d7b35: goto efa1d; e3e0c: $credentials = new Credentials($this->awsAccessKey, $this->awsSecretAccessKey); goto afc5b; afc5b: $this->wafClient = new WafClient(["\x76\145\162\x73\151\157\156" => "\x6c\141\164\145\163\x74", "\162\145\147\151\157\156" => $this->awsRegion, "\143\162\145\144\145\x6e\x74\151\x61\154\x73" => $credentials]); goto fea4f; efa1d: return $this->wafClient; goto Cfa23; Ef754: if (!(true === is_null($this->wafClient))) { goto d7b35; } goto e3e0c; Cfa23: } public function updateWebAcl(array $webAcl) { $wafClient = $this->getWafClient(); $this->retry(function () use($wafClient, $webAcl) { $webAcl["\123\143\x6f\160\145"] = self::SCOPE_REGIONAL; $wafClient->updateWebACL($webAcl); }); } public function updateIpSet($ipSetName, array $ips) { goto Ed991; Dad7b: $ipSet = $this->getIpSet($ipSetName); goto eb670; bdf34: if ("\166\64" == substr($ipSetName, -2)) { goto d4e2c; } goto E07fa; c0fa7: d4e2c: goto A06f0; eb670: $wafClient = $this->getWafClient(); goto d649a; E07fa: $ips = ["\62\60\x30\x31\x3a\x30\144\x62\70\x3a\x38\65\141\63\72\x30\x30\60\60\72\x30\60\60\60\72\70\x61\62\x65\x3a\x30\x33\x37\60\72\67\x33\x33\64\x2f\x31\62\70"]; goto b82fd; Ed991: $ips = array_unique($ips); goto bd182; b82fd: goto E17fb; goto c0fa7; d649a: $this->retry(function () use($wafClient, $ipSet, $ips) { goto F9652; C9849: $ipSetLockToken = $ipSet["\x4c\157\x63\x6b\124\x6f\153\x65\156"] ?? ''; goto bdabe; bdabe: $ipSetDescription = $ipSet["\x44\145\163\143\162\x69\160\x74\151\x6f\156"] ?? ''; goto B7116; B7116: $wafClient->updateIPSet(["\111\x64" => $ipSetId, "\x4e\x61\x6d\x65" => $ipSetName, "\114\157\143\x6b\124\x6f\153\x65\156" => $ipSetLockToken, "\x44\145\x73\x63\x72\x69\x70\x74\x69\157\156" => $ipSetDescription, "\x41\144\144\162\145\x73\x73\145\x73" => $ips, "\123\143\157\160\145" => self::SCOPE_REGIONAL]); goto db28a; A9447: $ipSetName = $ipSet["\x4e\x61\155\145"] ?? ''; goto C9849; F9652: $ipSetId = $ipSet["\x49\144"] ?? ''; goto A9447; db28a: }); goto F180d; bd182: if (!(true === empty($ips))) { goto bbabc; } goto bdf34; F8a7f: E17fb: goto e8a08; A06f0: $ips = ["\x35\x32\x2e\62\x38\x2e\x31\x34\x39\56\61\65\x37\57\x33\x32"]; goto F8a7f; e8a08: bbabc: goto Dad7b; F180d: } public function updateBlockedBotsRegexPatternSet(array $bots) { goto E194f; e4a8e: $regexString = sprintf("\50\x3f\x69\x29\50\45\x73\51", implode("\x7c", $bots)); goto Afa14; Afa14: $this->retry(function () use($wafClient, $regexPatternSet, $regexString) { goto Bcd08; b89b8: $regexPatternSetDescription = $regexPatternSet["\x44\145\x73\x63\x72\151\160\164\151\157\156"]; goto d54a9; Bcd08: $regexPatternSetId = $regexPatternSet["\x49\144"]; goto A81e6; A81e6: $regexPatternSetName = $regexPatternSet["\116\141\x6d\145"]; goto b89b8; d54a9: $regexPatternSetLockToken = $regexPatternSet["\114\x6f\143\153\124\157\153\145\x6e"]; goto Ae8c4; Ae8c4: $wafClient->updateRegexPatternSet(["\x49\144" => $regexPatternSetId, "\116\141\x6d\145" => $regexPatternSetName, "\104\145\163\143\x72\151\160\x74\151\x6f\156" => $regexPatternSetDescription, "\x4c\x6f\143\153\x54\157\x6b\145\x6e" => $regexPatternSetLockToken, "\122\145\x67\x75\154\x61\x72\x45\x78\x70\162\145\163\x73\151\x6f\156\x4c\x69\163\x74" => [["\x52\145\x67\145\x78\x53\x74\x72\151\156\147" => $regexString]], "\x53\x63\157\x70\x65" => self::SCOPE_REGIONAL]); goto C7405; C7405: }); goto A11b7; E194f: $regexPatternSet = $this->getRegexPatternSet(self::REGEX_PATTERN_SET_BLOCKED_BOTS); goto E6d4b; E6d4b: $wafClient = $this->getWafClient(); goto e4a8e; A11b7: } public function getIpAddressesForIpSet($ipSetName) { goto D29eb; Ed4fe: $ips = true === isset($ipSet["\101\144\144\162\x65\163\x73\x65\163"]) && false === empty($ipSet["\101\144\x64\x72\x65\x73\163\x65\163"]) ? $ipSet["\101\x64\x64\162\145\163\163\145\163"] : []; goto F879d; D29eb: $ipSet = $this->getIpSet($ipSetName); goto Ed4fe; F879d: return $ips; goto Fdcd1; Fdcd1: } public function getBlockedBots() { goto Dfc38; a81d8: if (!(true === isset($regexPatternSet["\122\145\147\x75\154\141\x72\x45\170\160\162\145\163\163\151\157\x6e\114\151\163\164"][0]["\122\x65\x67\x65\x78\123\x74\162\x69\156\x67"]))) { goto b0fe0; } goto d44ca; Dfc38: $bots = []; goto ab0b7; ab0b7: $regexPatternSet = $this->getRegexPatternSet(self::REGEX_PATTERN_SET_BLOCKED_BOTS); goto a81d8; c585f: b0fe0: goto c18dd; d44ca: $regexString = $regexPatternSet["\122\x65\x67\165\x6c\x61\x72\x45\170\160\x72\x65\163\x73\151\x6f\156\114\x69\163\x74"][0]["\x52\x65\x67\x65\x78\x53\164\162\x69\x6e\x67"]; goto C5f01; c18dd: return $bots; goto ae8c7; C5f01: $bots = explode("\x7c", substr($regexString, 5, -1)); goto c585f; ae8c7: } public function getWebAcls() { goto E43bd; B8369: Ebfa2: goto F5861; F5861: return $this->webAcls; goto a8ce1; ea72b: $result = $this->retry(function () use($wafClient) { $result = $wafClient->listWebACLs(["\123\143\157\x70\x65" => self::SCOPE_REGIONAL]); return $result; }); goto D0d3f; E43bd: if (!(true === empty($this->webAcls))) { goto Ebfa2; } goto fc3ed; D0d3f: $webAcls = (array) $result->get("\x57\x65\x62\101\103\114\163"); goto F960f; fc3ed: $wafClient = $this->getWafClient(); goto ea72b; ad1e6: D527e: goto A3efc; A3efc: E482c: goto B8369; Ca496: foreach ($webAcls as $webAcl) { $this->webAcls[] = $webAcl; e1fa0: } goto ad1e6; F960f: if (!(false === empty($webAcls))) { goto E482c; } goto Ca496; a8ce1: } public function getWebAcl($webAclName) { goto daad2; a653a: if (!(false === empty($webAcls))) { goto Ea222; } goto e560a; Ebee0: Ea222: goto Bd657; b1bf7: D475e: goto Ebee0; daad2: if (true === isset($this->webAclCache[$webAclName])) { goto de6b2; } goto Cce3a; C4ccb: d1613: goto D306e; D306e: throw new \Exception(sprintf("\127\145\x62\40\x41\103\x4c\x20\x22\45\163\42\56\x20\x6e\157\x74\x20\146\x6f\x75\x6e\144", $webAclName)); goto dd60f; af976: return $this->webAclCache[$webAclName]; goto C4ccb; Bd657: goto d1613; goto e0642; e0642: de6b2: goto af976; e560a: foreach ($webAcls as $webAcl) { goto C715b; c12e8: $webAcl["\114\157\x63\153\x54\157\x6b\x65\x6e"] = $webAclLockToken; goto Ee467; C715b: if (!(true === isset($webAcl["\x4e\141\155\x65"]) && $webAclName == $webAcl["\x4e\141\x6d\145"])) { goto f475b; } goto A9f55; Ee467: $this->webAclCache[$webAclName] = $webAcl; goto c1d42; aeb67: $webAcl = (array) $result->get("\x57\145\142\101\103\x4c"); goto c12e8; A9f55: $wafClient = $this->getWafClient(); goto ed14d; B9ad8: $webAclLockToken = $webAcl["\x4c\x6f\x63\x6b\124\x6f\x6b\x65\x6e"] ?? ''; goto aeb67; ed14d: $result = $this->retry(function () use($wafClient, $webAcl) { goto e3d87; aecc3: $webAclName = $webAcl["\116\x61\155\x65"] ?? ''; goto F772d; F772d: $result = $wafClient->getWebACL(["\111\x64" => $webAclId, "\116\x61\x6d\x65" => $webAclName, "\123\143\157\x70\x65" => self::SCOPE_REGIONAL]); goto eaa83; eaa83: return $result; goto Ed01e; e3d87: $webAclId = $webAcl["\x49\144"] ?? ''; goto aecc3; Ed01e: }); goto B9ad8; D11b2: f475b: goto c8988; c1d42: return $this->webAclCache[$webAclName]; goto D11b2; c8988: c5b31: goto A3bae; A3bae: } goto b1bf7; Cce3a: $webAcls = $this->getWebAcls(); goto a653a; dd60f: } protected function getIpSets() { goto F474e; A7835: if (!(false === empty($ipSets))) { goto a0aac; } goto e30c9; B80af: return $this->ipSets; goto ed0f8; E62a7: a0aac: goto B80af; B7dd4: $result = $this->retry(function () use($wafClient) { $result = $wafClient->listIPSets(["\123\x63\157\x70\145" => self::SCOPE_REGIONAL]); return $result; }); goto b6e80; b6e80: $ipSets = (array) $result->get("\x49\x50\123\x65\x74\163"); goto A7835; e30c9: $this->ipSets = $ipSets; goto E62a7; F474e: $wafClient = $this->getWafClient(); goto B7dd4; ed0f8: } protected function getIpSet($ipSetName) { goto E72fd; cdada: throw new \Exception(sprintf("\x49\120\x20\123\x65\x74\40\x22\x25\163\x22\x20\x6e\157\164\x20\146\x6f\x75\156\144\x2e", $ipSetName)); goto e7edd; C3d56: $ipSets = $this->getIpSets(); goto C7252; C7252: foreach ($ipSets as $wafIpSet) { goto E82a4; ff4f4: $ipSet = $wafIpSet; goto B1a12; C449e: $result = $this->retry(function () use($wafClient, $wafIpSetId, $wafIpSetName) { $result = $wafClient->getIPSet(["\111\x64" => $wafIpSetId, "\116\141\155\x65" => $wafIpSetName, "\x53\143\157\x70\x65" => self::SCOPE_REGIONAL]); return $result; }); goto cfd6f; f0f5c: $wafIpSet["\114\x6f\143\153\124\157\x6b\x65\x6e"] = $wafIpSetLockToken; goto ff4f4; cfd6f: $wafIpSet = (array) $result->get("\x49\120\123\145\x74"); goto c46b1; c85c7: if (!(false === empty($wafIpSetName) && $wafIpSetName == $ipSetName)) { goto Bc0fa; } goto eb5bd; B1a12: return $ipSet; goto b3571; F2d18: Bc0fa: goto B5aa8; e9dd9: goto f0c9b; goto F2d18; c46b1: if (!(false === empty($wafIpSet))) { goto D7d13; } goto f0f5c; Dd84b: $wafIpSetLockToken = $wafIpSet["\114\157\143\153\124\x6f\153\145\156"] ?? ''; goto c85c7; eb5bd: $wafClient = $this->getWafClient(); goto C449e; E82a4: $wafIpSetId = $wafIpSet["\x49\144"] ?? ''; goto dce15; b3571: D7d13: goto e9dd9; B5aa8: B27cf: goto Dc7d9; dce15: $wafIpSetName = $wafIpSet["\x4e\x61\155\145"] ?? ''; goto Dd84b; Dc7d9: } goto D3b64; Da161: $ipSetName = $this->getIpSetName($ipSetName); goto C3d56; E72fd: $ipSet = null; goto Da161; D3b64: f0c9b: goto cdada; e7edd: } protected function getRegexPatternSet($name) { goto ec3f0; b6e60: $regexPatternSets = $this->getRegexPatternSets(); goto c33b5; F1dd3: foreach ($regexPatternSets as $regexPatternSet) { goto E8240; Eca48: $data = $result->get("\122\x65\147\145\170\120\x61\164\x74\x65\x72\x6e\123\145\x74"); goto b693e; E8240: $regexPatternSetName = $regexPatternSet["\116\x61\x6d\145"] ?? ''; goto ab968; A6470: $regexPatternSet["\x4c\x6f\143\x6b\x54\x6f\153\145\156"] = $data["\x4c\157\143\153\124\157\153\145\156"]; goto B079f; ab968: if (!(false === empty($regexPatternSetName) && $regexPatternSetName == $name)) { goto Ac467; } goto C178c; C178c: $wafClient = $this->getWafClient(); goto D2e4a; C7581: a45b0: goto Fc325; b693e: if (!(true === isset($data["\122\145\x67\165\x6c\141\162\x45\x78\x70\x72\x65\163\163\x69\x6f\x6e\114\151\x73\x74"]))) { goto a45b0; } goto E9fb1; E9fb1: $regexPatternSet["\122\x65\147\165\x6c\x61\x72\105\x78\x70\162\x65\x73\x73\151\157\x6e\x4c\151\x73\164"] = $data["\x52\x65\x67\x75\x6c\141\162\x45\x78\160\162\145\163\163\x69\x6f\x6e\x4c\x69\x73\164"]; goto C7581; aec5c: return $regexPatternSet; goto cc348; Fc325: if (!(true === isset($data["\x4c\x6f\143\153\124\x6f\153\145\156"]))) { goto c9923; } goto A6470; f6078: ec051: goto Afc41; A8de1: Ac467: goto f6078; cc348: goto f9ae5; goto A8de1; D2e4a: $result = $this->retry(function () use($wafClient, $regexPatternSet) { goto C5709; C5709: $regexPatternSetId = $regexPatternSet["\x49\144"] ?? ''; goto A435b; E452b: return $result; goto b57bc; A435b: $regexPatternSetName = $regexPatternSet["\116\141\x6d\145"] ?? ''; goto Aae1c; Aae1c: $result = $wafClient->getRegexPatternSet(["\111\x64" => $regexPatternSetId, "\116\x61\x6d\x65" => $regexPatternSetName, "\123\x63\157\160\x65" => self::SCOPE_REGIONAL]); goto E452b; b57bc: }); goto Eca48; B079f: c9923: goto aec5c; Afc41: } goto b93df; c33b5: if (!(false === empty($regexPatternSets))) { goto Ae6fd; } goto F1dd3; ec3f0: $name = $this->getRegexPatternSetName($name); goto b6e60; F4609: Ae6fd: goto c1011; b93df: f9ae5: goto F4609; c1011: throw new \Exception(sprintf("\x52\145\147\145\170\40\120\141\164\x74\145\x72\x6e\x20\123\x65\x74\40\x22\x25\x73\x22\x20\x6e\157\164\x20\146\157\165\x6e\x64", $name)); goto a3ada; a3ada: } protected function getRegexPatternSets() { goto Fe890; ce796: Cd5da: goto fd516; c1bc0: $this->regexPatternSets = $regexPatternSets; goto ce796; fc5d5: $regexPatternSets = (array) $result->get("\x52\145\147\145\170\120\x61\164\x74\145\x72\156\x53\x65\164\163"); goto Cca6b; Cca6b: if (!(false === empty($regexPatternSets))) { goto Cd5da; } goto c1bc0; a6f0d: $result = $this->retry(function () use($wafClient) { $result = $wafClient->listRegexPatternSets(["\123\x63\157\x70\145" => self::SCOPE_REGIONAL]); return $result; }); goto fc5d5; Fe890: $wafClient = $this->getWafClient(); goto a6f0d; fd516: return $this->regexPatternSets; goto db3aa; db3aa: } protected function getRegexPatternSetName($regexPatternSetName) { goto Cefc5; Cefc5: $projectName = ucfirst($this->getProjectName()); goto Bc9de; Bc9de: $regexPatternSetName = sprintf("\x25\163\55\x4d\107\124\x2d\x25\x73", $projectName, $regexPatternSetName); goto f4ec0; f4ec0: return $regexPatternSetName; goto f58c4; f58c4: } public function getBlockedCountryCodes($webAclName) { goto B2998; B2998: $blockedCountryCodes = []; goto a90b2; ddadb: $blockedCountryCodes = $webAclRule["\123\164\141\164\145\x6d\145\x6e\x74"]["\107\x65\157\115\141\x74\x63\x68\x53\164\141\164\x65\155\145\156\164"]["\103\157\165\156\x74\x72\171\103\x6f\x64\145\163"]; goto dfc5a; dfc5a: f2306: goto b14d9; b14d9: return $blockedCountryCodes; goto Aea93; Ea20f: if (!(true === isset($webAclRule["\123\164\141\x74\x65\x6d\145\156\x74"]["\x47\145\157\115\141\x74\143\150\123\164\x61\x74\x65\x6d\x65\x6e\x74"]["\x43\x6f\165\x6e\164\x72\x79\x43\157\144\x65\163"]) && false === empty($webAclRule["\x53\164\x61\164\x65\x6d\145\x6e\164"]["\x47\145\x6f\115\x61\x74\x63\x68\x53\x74\141\x74\145\155\x65\156\164"]["\103\157\165\156\164\x72\171\x43\157\144\x65\163"]))) { goto f2306; } goto ddadb; C4e9e: $webAclRule = $this->getWebAclRule($webAcl, self::WEB_ACL_RULE_NAME_BLOCKED_COUNTRIES); goto Ea20f; a90b2: $webAcl = $this->getWebAcl($webAclName); goto C4e9e; Aea93: } public function getWebAclRule(array $webAcl, $webAclRuleName) { goto ba8f7; E5cc0: f7bc1: goto Ad7f3; B4adc: foreach ($webAclRules as $webAclRule) { goto dd4d9; dd4d9: if (!(true === isset($webAclRule["\116\x61\x6d\145"]) && $webAclRule["\x4e\141\x6d\x65"] == $webAclRuleName)) { goto Da16f; } goto b194b; B2f40: Da16f: goto a4366; b194b: $webAclRuleFound = true; goto A5db0; A5db0: goto f7bc1; goto B2f40; a4366: E7eef: goto c49a9; c49a9: } goto E5cc0; c9b83: throw new \Exception(sprintf("\x57\145\x62\x20\101\x43\x4c\x20\122\x75\154\x65\40\x22\x25\163\x22\40\x6e\x6f\x74\x20\x66\x6f\165\x6e\144\x2e", $webAclRuleName)); goto da168; A140a: return $webAclRule; goto E6484; Cace1: if (false === $webAclRuleFound) { goto C0e00; } goto A140a; d1e15: if (!(false === empty($webAclRules))) { goto A6b37; } goto B4adc; da168: d68c3: goto f7259; ec562: $webAclRule = null; goto f2365; A6df1: $webAclRuleFound = false; goto ec562; ba8f7: $webAclRuleName = $this->getWebAclRuleName($webAclRuleName); goto A6df1; E6484: goto d68c3; goto Ab4d2; Ab4d2: C0e00: goto c9b83; f2365: $webAclRules = $webAcl["\x52\165\x6c\x65\163"] ?? []; goto d1e15; Ad7f3: A6b37: goto Cace1; f7259: } public function getRateLimit($webAclName) { goto f3f7d; E635b: goto ed60e; goto Df7ec; Ca20f: throw new \Exception(sprintf("\127\x65\x62\40\x41\103\114\40\x52\x75\x6c\145\40\42\45\x73\x22\x20\156\157\164\40\146\157\165\x6e\144\x2e", $webbAclRuleName)); goto F9412; Df7ec: Ad2d9: goto A04aa; f3f7d: $webAcl = $this->getWebAcl($webAclName); goto Da090; A04aa: $webbAclRuleName = $this->getWebAclRuleName(self::WEB_ACL_RULE_NAME_RATE_LIMIT_IPV4); goto f0c63; da672: Dc09e: goto F75eb; e6527: throw new \Exception(sprintf("\x55\x6e\x61\142\154\x65\x20\x74\157\40\x67\x65\164\x20\x57\145\x62\x20\x41\x43\x4c\40\x22\45\x73\x22\56", $webAclName)); goto E635b; a90df: if (false === is_null($webAclRule)) { goto D995b; } goto Ca20f; a40b8: D995b: goto Daa08; Da090: if (false === is_null($webAcl)) { goto Ad2d9; } goto e6527; F9412: goto Dc09e; goto a40b8; Daa08: $rateLimit = $webAclRule["\123\x74\x61\x74\x65\155\x65\x6e\164"]["\122\x61\164\145\x42\141\x73\145\x64\123\164\x61\x74\145\155\145\x6e\x74"]["\114\x69\x6d\151\x74"] ?? ''; goto Ead88; F75eb: ed60e: goto c6a16; Ead88: return $rateLimit; goto da672; f0c63: $webAclRule = $this->getWebAclRule($webAcl, self::WEB_ACL_RULE_NAME_RATE_LIMIT_IPV4); goto a90df; c6a16: } public function getWebAclRuleName($webAclRuleName) { goto E67a9; E67a9: $projectName = ucfirst($this->getProjectName()); goto cd2c4; e3727: return $webAclRuleName; goto e6d4d; cd2c4: $webAclRuleName = sprintf("\x25\x73\55\115\x47\124\x2d\x25\x73", $projectName, $webAclRuleName); goto e3727; e6d4d: } public function getIpSetName($ipSetName) { goto A9c24; Ea697: return $ipSetName; goto C5063; A9c24: $projectName = ucfirst($this->getProjectName()); goto f31e3; f31e3: $ipSetName = sprintf("\45\x73\55\115\x47\124\55\x25\x73", $projectName, $ipSetName); goto Ea697; C5063: } protected function getProjectName() { return $this->projectName; } protected function retry(callable $fn, $retries = 2, $delay = 15) { return Retry::retry($fn, $retries, $delay); } }
