<?php
 namespace Mgt\Waf\Model\Config\BackendModel; use Mgt\Waf\Model\Config\BackendModel\Value as ConfigValue; use Mgt\Waf\Model\Aws\Waf as AwsWaf; class BlockedIps extends ConfigValue { protected function _afterLoad() { goto b05dc; c1f25: $awsWaf = new AwsWaf($awsAccessKey, $awsSecretAccessKey, $awsRegion, $projectName); goto E7ca3; bf31a: $projectName = $this->getProjectName(); goto Dc059; Eef70: af968: goto A985a; b05dc: $sessionConfigData = $this->getSessionConfigData(); goto badd7; fda32: c77cf: goto B5a13; B687f: foreach ($blockedIpsIPv4 as $ip) { goto fdabc; d49a9: D4d10: goto E59fd; e652e: $blockedIps[] = substr($ip, 0, -3); goto Fc9a2; Fc9a2: aa317: goto d49a9; fdabc: if (!(substr($ip, -3) == "\57\x33\62")) { goto aa317; } goto e652e; E59fd: } goto fda32; f1fef: $blockedIpsIPv6 = $awsWaf->getIpAddressesForIpSet(AwsWaf::IP_SET_BLOCKED_IPS_IPV6); goto d2ca4; Ef4e9: $awsSecretAccessKey = $this->getAwsSecretAccessKey(); goto C9104; e546b: a4f4d: goto a01f6; f0ed1: e0276: goto e3a28; B5a13: f85a7: goto f1fef; c3843: foreach ($blockedIpsIPv6 as $ip) { goto cb5d2; cb5d2: if (!(substr($ip, -4) == "\x2f\61\x32\x38")) { goto Bee25; } goto bd656; D1406: a0c37: goto C1022; bd656: $blockedIps[] = substr($ip, 0, -4); goto A9ea6; A9ea6: Bee25: goto D1406; C1022: } goto F19da; E7ca3: $blockedIpsIPv4 = $awsWaf->getIpAddressesForIpSet(AwsWaf::IP_SET_BLOCKED_IPS_IPV4); goto C2d3f; bce89: if (true === isset($sessionConfigData["\147\162\x6f\x75\160\x73"]["\142\154\157\x63\153\145\x64\137\x69\x70\163"]["\x66\151\145\x6c\144\x73"]["\x62\x6c\157\x63\153\x65\x64\137\x69\160\163"]["\166\141\154\165\145"])) { goto a5623; } goto Fc1d2; e3a28: $this->setValue($value); goto f48f7; a01f6: goto e0276; goto F6135; F19da: c7892: goto Eef70; A985a: $value = implode(PHP_EOL, $blockedIps); goto e546b; Fc1d2: $awsAccessKey = $this->getAwsAccessKey(); goto bf31a; D3609: $value = $sessionConfigData["\x67\x72\x6f\x75\x70\163"]["\x62\154\x6f\143\153\x65\144\x5f\x69\x70\x73"]["\x66\x69\145\154\144\163"]["\x62\154\x6f\143\153\145\x64\137\151\160\x73"]["\166\x61\x6c\165\145"]; goto f0ed1; C2d3f: if (!(false === empty($blockedIpsIPv4))) { goto f85a7; } goto B687f; badd7: $value = ''; goto bce89; C9104: $awsRegion = $this->getAwsRegion(); goto Beaf8; Beaf8: $blockedIps = []; goto c1f25; Dc059: if (!(false === empty($awsAccessKey) && false === empty($projectName))) { goto a4f4d; } goto Ef4e9; F6135: a5623: goto D3609; d2ca4: if (!(false === empty($blockedIpsIPv6))) { goto af968; } goto c3843; f48f7: } }
