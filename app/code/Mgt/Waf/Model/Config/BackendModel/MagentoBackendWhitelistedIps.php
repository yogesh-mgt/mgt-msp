<?php
 namespace Mgt\Waf\Model\Config\BackendModel; use Mgt\Waf\Model\Config\BackendModel\Value as ConfigValue; use Mgt\Waf\Model\Aws\Waf as AwsWaf; class MagentoBackendWhitelistedIps extends ConfigValue { protected function _afterLoad() { goto A87ec; fb292: cda7b: goto Ae110; Dc7ca: $this->setValue($value); goto be040; e8b47: $value = ''; goto d23d1; fb265: $awsRegion = $this->getAwsRegion(); goto Cac9b; c569c: if (!(false === empty($magentoBackendWhitelistedIpv4))) { goto D9e06; } goto E7cd0; A4ad1: b2f0d: goto Dc7ca; e8077: e3faa: goto Bf010; ee955: if (!(false === empty($awsAccessKey) && false === empty($projectName))) { goto Fc975; } goto f90e9; Bf010: $value = implode(PHP_EOL, $whitelistedIps); goto cd86a; ac7a8: foreach ($magentoBackendWhitelistedIpv6 as $ip) { goto f013e; f013e: if (!(substr($ip, -4) == "\x2f\x31\x32\70")) { goto D2455; } goto b52e3; ae057: cdd84: goto Ffd03; b52e3: $whitelistedIps[] = substr($ip, 0, -4); goto a661b; a661b: D2455: goto ae057; Ffd03: } goto D3711; A87ec: $sessionConfigData = $this->getSessionConfigData(); goto e8b47; d9b30: if (!(false === empty($magentoBackendWhitelistedIpv6))) { goto e3faa; } goto ac7a8; b00ad: $magentoBackendWhitelistedIpv6 = $awsWaf->getIpAddressesForIpSet(AwsWaf::IP_SET_MAGENTO_BACKEND_WHITELISTED_IPV6); goto d9b30; E7cd0: foreach ($magentoBackendWhitelistedIpv4 as $ip) { goto deca0; Ea9db: f8f9c: goto D57bd; deca0: if (!(substr($ip, -3) == "\57\63\x32")) { goto f8f9c; } goto ef091; D57bd: E566d: goto B4d71; ef091: $whitelistedIps[] = substr($ip, 0, -3); goto Ea9db; B4d71: } goto fb292; df583: $value = $sessionConfigData["\147\162\x6f\165\160\163"]["\x6d\x61\147\145\156\164\x6f\137\x62\141\x63\153\x65\x6e\x64"]["\x66\x69\145\154\144\x73"]["\x77\150\x69\164\x65\x6c\151\163\164\x65\144\137\151\x70\163"]["\166\x61\154\x75\x65"]; goto A4ad1; d23d1: if (true === isset($sessionConfigData["\147\162\157\x75\x70\163"]["\155\141\x67\145\x6e\164\157\x5f\142\x61\143\153\145\156\x64"]["\x66\151\145\154\144\163"]["\x77\x68\x69\164\x65\154\151\163\x74\145\x64\x5f\x69\160\x73"]["\x76\141\x6c\165\145"])) { goto deb7d; } goto fa037; A8bbc: deb7d: goto df583; B0cd5: goto b2f0d; goto A8bbc; fa037: $awsAccessKey = $this->getAwsAccessKey(); goto db3ec; fb579: $awsWaf = new AwsWaf($awsAccessKey, $awsSecretAccessKey, $awsRegion, $projectName); goto B31fb; B31fb: $magentoBackendWhitelistedIpv4 = $awsWaf->getIpAddressesForIpSet(AwsWaf::IP_SET_MAGENTO_BACKEND_WHITELISTED_IPV4); goto c569c; cd86a: Fc975: goto B0cd5; D3711: ac12f: goto e8077; Cac9b: $whitelistedIps = []; goto fb579; f90e9: $awsSecretAccessKey = $this->getAwsSecretAccessKey(); goto fb265; Ae110: D9e06: goto b00ad; db3ec: $projectName = $this->getProjectName(); goto ee955; be040: } }
