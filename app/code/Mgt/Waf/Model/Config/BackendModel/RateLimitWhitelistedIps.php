<?php
 namespace Mgt\Waf\Model\Config\BackendModel; use Mgt\Waf\Model\Config\BackendModel\Value as ConfigValue; use Mgt\Waf\Model\Aws\Waf as AwsWaf; class RateLimitWhitelistedIps extends ConfigValue { protected function _afterLoad() { goto f650b; e0a29: $value = implode(PHP_EOL, $whitelistedIps); goto Ca33c; f650b: $sessionConfigData = $this->getSessionConfigData(); goto cc457; f79d0: Bec21: goto e0a29; c9492: C3044: goto D6dd7; cfc96: $rateLimitWhitelistedIpv4 = $awsWaf->getIpAddressesForIpSet(AwsWaf::IP_SET_RATE_LIMIT_WHITELISTED_IPV4); goto Bbf3a; Be6a0: $awsWaf = new AwsWaf($awsAccessKey, $awsSecretAccessKey, $awsRegion, $projectName); goto cfc96; Caabd: foreach ($rateLimitWhitelistedIpv6 as $ip) { goto Cd649; ad028: ce4cb: goto D8cbe; Cd649: if (!(substr($ip, -4) == "\x2f\x31\x32\70")) { goto Eeedf; } goto f6a7d; e5ca6: Eeedf: goto ad028; f6a7d: $whitelistedIps[] = substr($ip, 0, -4); goto e5ca6; D8cbe: } goto B7928; B6112: if (!(false === empty($rateLimitWhitelistedIpv6))) { goto Bec21; } goto Caabd; cae57: A0319: goto c9492; Ca33c: be0ad: goto Cbdf4; c6e7e: if (true === isset($sessionConfigData["\x67\x72\157\x75\160\x73"]["\162\x61\x74\145\137\x6c\x69\155\x69\x74"]["\146\151\x65\x6c\x64\x73"]["\167\150\151\x74\x65\154\151\x73\x74\x65\144\137\x69\x70\x73"]["\166\141\x6c\165\x65"])) { goto f09d3; } goto C8ed6; F70a6: d25ea: goto B85eb; C8ed6: $awsAccessKey = $this->getAwsAccessKey(); goto d3ad3; B85eb: $this->setValue($value); goto b81e7; bcb97: $awsSecretAccessKey = $this->getAwsSecretAccessKey(); goto a75db; c81a4: $value = $sessionConfigData["\147\162\157\x75\160\x73"]["\162\x61\164\x65\137\x6c\x69\x6d\151\164"]["\x66\x69\145\x6c\144\163"]["\x77\x68\x69\x74\x65\x6c\x69\x73\x74\x65\x64\x5f\x69\160\x73"]["\166\141\x6c\165\145"]; goto F70a6; D6dd7: $rateLimitWhitelistedIpv6 = $awsWaf->getIpAddressesForIpSet(AwsWaf::IP_SET_RATE_LIMIT_WHITELISTED_IPV6); goto B6112; Bbf3a: if (!(false === empty($rateLimitWhitelistedIpv4))) { goto C3044; } goto E340e; a4198: f09d3: goto c81a4; E340e: foreach ($rateLimitWhitelistedIpv4 as $ip) { goto bac48; f06ef: Ab8e8: goto c4431; c86c4: $whitelistedIps[] = substr($ip, 0, -3); goto c3125; bac48: if (!(substr($ip, -3) == "\57\x33\x32")) { goto D89e8; } goto c86c4; c3125: D89e8: goto f06ef; c4431: } goto cae57; cc457: $value = ''; goto c6e7e; d3ad3: $projectName = $this->getProjectName(); goto e5191; Cbdf4: goto d25ea; goto a4198; a75db: $awsRegion = $this->getAwsRegion(); goto d7f78; e5191: if (!(false === empty($awsAccessKey) && false === empty($projectName))) { goto be0ad; } goto bcb97; d7f78: $whitelistedIps = []; goto Be6a0; B7928: f0637: goto f79d0; b81e7: } }
